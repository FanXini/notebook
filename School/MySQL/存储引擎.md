---
typora-copy-images-to: ..\..\img
---

# 存储引擎

存储引擎是MySQL数据库的特性，它实现了存储和查询分离，不同的存储引擎适应于相同的查询语句。这种存储和查询分离的特性可以使得用户在使用时可以根据业务和数据特性以及其他性能选择合适的存储引擎进行数据存储。

## MySQL的逻辑架构图

![1552356251178](..\..\img\1552356251178.png)

- 最上层的服务不是Mysql独有的，大多数基于客户端/服务器的工具都有类似架构，比如连接处理，授权认证、安全等。
- 第二层时MySQL比较有意思的部分。大多数MySQL的核心服务功能都在这一层，包括查询解析、分析、优化、缓存以及所有的内置函数(时间、日期、熟悉、加密、字符串)，<font color='red'>所有跨存储引擎的功能都实现在这一层：存储过程、触发器、视图等。</font>
- 第三层就是存储引擎。存储引擎负责数据的存储和提取。每个存储引擎都有它的优势和劣势。服务器通过API和它们通信，这些接口屏蔽了不同存储引擎之间的差异，使得这些差异对上层的查询透明。存储引擎不会取解析SQL(除了InnoDB之外，它会解析外键，因为MySQL服务器本身没有时间外键这个功能)，不同的存储引擎之间不会通信，只是简单的响应上层服务器的请求。

这里只介绍两个存储引擎：

- InnoDB
- MyISAM

## InnoDB

- 支持行级锁
- 支持事务
- 采用MVCC来支持高并发
- 默认事务基本是可重复度，并通过间隙锁(next-key locking)策略防止幻读的出现。间隙锁不仅仅锁定查询涉及的行，还会对索引中的间隙进行锁定，以防止幻影行的插入。
- InnoDB表基于聚簇索引建立。
- 修复能力强。

## MyISAM

- 不支持事务和行级锁
- 表锁而不是行锁
- 支持全文索引
- 修复能力差

